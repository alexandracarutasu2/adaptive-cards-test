{"id":"../../node_modules/adaptivecards/lib/utils.js","dependencies":[{"name":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\lib\\utils.js.map","includedInParent":true,"mtime":1689085533912},{"name":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\src\\utils.ts","includedInParent":true,"mtime":1689085534081},{"name":"C:\\Users\\t-acruau\\adaptive-cards\\package.json","includedInParent":true,"mtime":1689259513501},{"name":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\package.json","includedInParent":true,"mtime":1689085533782},{"name":"./enums","loc":{"line":7,"column":20,"index":649},"parent":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\lib\\utils.js","resolved":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\lib\\enums.js"},{"name":"./shared","loc":{"line":8,"column":21,"index":682},"parent":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\lib\\utils.js","resolved":"C:\\Users\\t-acruau\\node_modules\\adaptivecards\\lib\\shared.js"}],"generated":{"js":"\"use strict\";\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.debounce = exports.addCancelSelectActionEventHandler = exports.clearElementChildren = exports.getScrollY = exports.getScrollX = exports.getFitStatus = exports.truncate = exports.truncateText = exports.stringToCssColor = exports.parseEnum = exports.getEnumValueByName = exports.parseBool = exports.parseNumber = exports.parseString = exports.appendChild = exports.generateUniqueId = exports.isMobileOS = exports.isInternetExplorer = void 0;\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar Enums = require(\"./enums\");\nvar Shared = require(\"./shared\");\nfunction isInternetExplorer() {\n    // The documentMode property only exists in IE\n    return window.document.documentMode !== undefined;\n}\nexports.isInternetExplorer = isInternetExplorer;\nfunction isMobileOS() {\n    var userAgent = window.navigator.userAgent;\n    return (!!userAgent.match(/Android/i) || !!userAgent.match(/iPad/i) || !!userAgent.match(/iPhone/i));\n}\nexports.isMobileOS = isMobileOS;\n/**\n * Generate a UUID prepended with \"__ac-\"\n */\nfunction generateUniqueId() {\n    return \"__ac-\" + Shared.UUID.generate();\n}\nexports.generateUniqueId = generateUniqueId;\nfunction appendChild(node, child) {\n    if (child) {\n        node.appendChild(child);\n    }\n}\nexports.appendChild = appendChild;\nfunction parseString(obj, defaultValue) {\n    return typeof obj === \"string\" ? obj : defaultValue;\n}\nexports.parseString = parseString;\nfunction parseNumber(obj, defaultValue) {\n    return typeof obj === \"number\" ? obj : defaultValue;\n}\nexports.parseNumber = parseNumber;\nfunction parseBool(value, defaultValue) {\n    if (typeof value === \"boolean\") {\n        return value;\n    }\n    else if (typeof value === \"string\") {\n        switch (value.toLowerCase()) {\n            case \"true\":\n                return true;\n            case \"false\":\n                return false;\n            default:\n                return defaultValue;\n        }\n    }\n    return defaultValue;\n}\nexports.parseBool = parseBool;\nfunction getEnumValueByName(enumType, name) {\n    // eslint-disable-next-line guard-for-in\n    for (var key in enumType) {\n        var keyAsNumber = parseInt(key, 10);\n        if (keyAsNumber >= 0) {\n            var value = enumType[key];\n            if (value && typeof value === \"string\" && value.toLowerCase() === name.toLowerCase()) {\n                return keyAsNumber;\n            }\n        }\n    }\n    return undefined;\n}\nexports.getEnumValueByName = getEnumValueByName;\nfunction parseEnum(enumType, name, defaultValue) {\n    if (!name) {\n        return defaultValue;\n    }\n    var enumValue = getEnumValueByName(enumType, name);\n    return enumValue !== undefined ? enumValue : defaultValue;\n}\nexports.parseEnum = parseEnum;\nfunction stringToCssColor(color) {\n    if (color) {\n        var regEx = /#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;\n        var matches = regEx.exec(color);\n        if (matches && matches[4]) {\n            var a = parseInt(matches[1], 16) / 255;\n            var r = parseInt(matches[2], 16);\n            var g = parseInt(matches[3], 16);\n            var b = parseInt(matches[4], 16);\n            return \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a + \")\";\n        }\n    }\n    return color;\n}\nexports.stringToCssColor = stringToCssColor;\nfunction truncateWorker(element, maxHeight, fullText, truncateAt, lineHeight) {\n    var fits = function () {\n        // Allow a one pixel overflow to account for rounding differences\n        // between browsers\n        return maxHeight - element.scrollHeight >= -1.0;\n    };\n    if (fits()) {\n        return;\n    }\n    var breakableIndices = findBreakableIndices(fullText);\n    var lo = 0;\n    var hi = breakableIndices.length;\n    var bestBreakIdx = 0;\n    // Do a binary search for the longest string that fits\n    while (lo < hi) {\n        var mid = Math.floor((lo + hi) / 2);\n        truncateAt(fullText, breakableIndices[mid]);\n        if (fits()) {\n            bestBreakIdx = breakableIndices[mid];\n            lo = mid + 1;\n        }\n        else {\n            hi = mid;\n        }\n    }\n    truncateAt(fullText, bestBreakIdx);\n    // If we have extra room, try to expand the string letter by letter\n    // (covers the case where we have to break in the middle of a long word)\n    if (lineHeight && maxHeight - element.scrollHeight >= lineHeight - 1.0) {\n        var idx = findNextCharacter(fullText, bestBreakIdx);\n        while (idx < fullText.length) {\n            truncateAt(fullText, idx);\n            if (fits()) {\n                bestBreakIdx = idx;\n                idx = findNextCharacter(fullText, idx);\n            }\n            else {\n                break;\n            }\n        }\n        truncateAt(fullText, bestBreakIdx);\n    }\n}\nfunction truncateText(element, maxHeight, lineHeight) {\n    truncateWorker(element, maxHeight, element.innerText, function (text, idx) {\n        element.innerText = text.substring(0, idx) + \"...\";\n    }, lineHeight);\n}\nexports.truncateText = truncateText;\n/**\n * {@link truncate} has been deprecated and is no longer in use internally. This policy passes\n * content through as it always has, which is _supposed_ to be dealing with text only (see {@link\n * TextBlock.truncateIfSupported}), but had a bug where it might actually pass through an element\n * for which innerHTML yielded actual HTML (since fixed).\n */\nvar ttDeprecatedPolicy = (typeof window === 'undefined') ? undefined : (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy(\"adaptivecards#deprecatedExportedFunctionPolicy\", {\n    createHTML: function (value) { return value; }\n});\n/** @deprecated Use {@link truncateText} instead. */\nfunction truncate(element, maxHeight, lineHeight) {\n    truncateWorker(element, maxHeight, element.innerHTML, function (text, idx) {\n        var _a;\n        var truncatedString = text.substring(0, idx) + \"...\";\n        var truncatedHTML = (_a = ttDeprecatedPolicy === null || ttDeprecatedPolicy === void 0 ? void 0 : ttDeprecatedPolicy.createHTML(truncatedString)) !== null && _a !== void 0 ? _a : truncatedString;\n        element.innerHTML = truncatedHTML;\n    }, lineHeight);\n}\nexports.truncate = truncate;\nfunction findBreakableIndices(html) {\n    var results = [];\n    var idx = findNextCharacter(html, -1);\n    while (idx < html.length) {\n        if (html[idx] === \" \") {\n            results.push(idx);\n        }\n        idx = findNextCharacter(html, idx);\n    }\n    return results;\n}\nfunction findNextCharacter(html, currIdx) {\n    currIdx += 1;\n    // If we found the start of an HTML tag, keep advancing until we get\n    // past it, so we don't end up truncating in the middle of the tag\n    while (currIdx < html.length && html[currIdx] === \"<\") {\n        while (currIdx < html.length && html[currIdx++] !== \">\") {\n            continue;\n        }\n    }\n    return currIdx;\n}\nfunction getFitStatus(element, containerEnd) {\n    var start = element.offsetTop;\n    var end = start + element.clientHeight;\n    if (end <= containerEnd) {\n        return Enums.ContainerFitStatus.FullyInContainer;\n    }\n    else if (start < containerEnd) {\n        return Enums.ContainerFitStatus.Overflowing;\n    }\n    else {\n        return Enums.ContainerFitStatus.FullyOutOfContainer;\n    }\n}\nexports.getFitStatus = getFitStatus;\nfunction getScrollX() {\n    return window.pageXOffset;\n}\nexports.getScrollX = getScrollX;\nfunction getScrollY() {\n    return window.pageYOffset;\n}\nexports.getScrollY = getScrollY;\nfunction clearElementChildren(element) {\n    while (element.firstChild) {\n        element.removeChild(element.firstChild);\n    }\n}\nexports.clearElementChildren = clearElementChildren;\nfunction addCancelSelectActionEventHandler(element) {\n    element.onclick = function (e) {\n        e.preventDefault();\n        e.cancelBubble = true;\n    };\n}\nexports.addCancelSelectActionEventHandler = addCancelSelectActionEventHandler;\nfunction debounce(fn, delay) {\n    var timer;\n    function debouncedFn() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (timer) {\n            clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n            fn.apply(void 0, args);\n        }, delay);\n    }\n    return debouncedFn;\n}\nexports.debounce = debounce;\n"},"sourceMaps":{"js":{"version":3,"file":"utils.js","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nimport * as Enums from \"./enums\";\nimport * as Shared from \"./shared\";\n\n// To work around TypeScript complaining about documentMode not being declared\n// on type Document\ndeclare global {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    interface Document {\n        documentMode?: any;\n    }\n}\n\nexport function isInternetExplorer(): boolean {\n    // The documentMode property only exists in IE\n    return window.document.documentMode !== undefined;\n}\n\nexport function isMobileOS(): boolean {\n    const userAgent = window.navigator.userAgent;\n\n    return (\n        !!userAgent.match(/Android/i) || !!userAgent.match(/iPad/i) || !!userAgent.match(/iPhone/i)\n    );\n}\n\n/**\n * Generate a UUID prepended with \"__ac-\"\n */\nexport function generateUniqueId(): string {\n    return \"__ac-\" + Shared.UUID.generate();\n}\n\nexport function appendChild(node: Node, child: Node | undefined) {\n    if (child) {\n        node.appendChild(child);\n    }\n}\n\nexport function parseString(obj: any, defaultValue?: string): string | undefined {\n    return typeof obj === \"string\" ? obj : defaultValue;\n}\n\nexport function parseNumber(obj: any, defaultValue?: number): number | undefined {\n    return typeof obj === \"number\" ? obj : defaultValue;\n}\n\nexport function parseBool(value: any, defaultValue?: boolean): boolean | undefined {\n    if (typeof value === \"boolean\") {\n        return value;\n    } else if (typeof value === \"string\") {\n        switch (value.toLowerCase()) {\n            case \"true\":\n                return true;\n            case \"false\":\n                return false;\n            default:\n                return defaultValue;\n        }\n    }\n\n    return defaultValue;\n}\n\nexport function getEnumValueByName(\n    enumType: { [s: number]: string },\n    name: string\n): number | undefined {\n    // eslint-disable-next-line guard-for-in\n    for (const key in enumType) {\n        const keyAsNumber = parseInt(key, 10);\n\n        if (keyAsNumber >= 0) {\n            const value = enumType[key];\n\n            if (value && typeof value === \"string\" && value.toLowerCase() === name.toLowerCase()) {\n                return keyAsNumber;\n            }\n        }\n    }\n\n    return undefined;\n}\n\nexport function parseEnum(\n    enumType: { [s: number]: string },\n    name: string,\n    defaultValue?: number\n): number | undefined {\n    if (!name) {\n        return defaultValue;\n    }\n\n    const enumValue = getEnumValueByName(enumType, name);\n\n    return enumValue !== undefined ? enumValue : defaultValue;\n}\n\nexport function stringToCssColor(color: string | undefined): string | undefined {\n    if (color) {\n        const regEx = /#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;\n        const matches = regEx.exec(color);\n\n        if (matches && matches[4]) {\n            const a = parseInt(matches[1], 16) / 255;\n            const r = parseInt(matches[2], 16);\n            const g = parseInt(matches[3], 16);\n            const b = parseInt(matches[4], 16);\n\n            return \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a + \")\";\n        }\n    }\n\n    return color;\n}\n\nfunction truncateWorker(\n    element: HTMLElement,\n    maxHeight: number,\n    fullText: string,\n    truncateAt: (text: string, idx: number) => void,\n    lineHeight?: number\n) {\n    const fits = () => {\n        // Allow a one pixel overflow to account for rounding differences\n        // between browsers\n        return maxHeight - element.scrollHeight >= -1.0;\n    };\n\n    if (fits()) {\n        return;\n    }\n\n    const breakableIndices = findBreakableIndices(fullText);\n    let lo = 0;\n    let hi = breakableIndices.length;\n    let bestBreakIdx = 0;\n\n    // Do a binary search for the longest string that fits\n    while (lo < hi) {\n        const mid = Math.floor((lo + hi) / 2);\n        truncateAt(fullText, breakableIndices[mid]);\n\n        if (fits()) {\n            bestBreakIdx = breakableIndices[mid];\n            lo = mid + 1;\n        } else {\n            hi = mid;\n        }\n    }\n\n    truncateAt(fullText, bestBreakIdx);\n\n    // If we have extra room, try to expand the string letter by letter\n    // (covers the case where we have to break in the middle of a long word)\n    if (lineHeight && maxHeight - element.scrollHeight >= lineHeight - 1.0) {\n        let idx = findNextCharacter(fullText, bestBreakIdx);\n\n        while (idx < fullText.length) {\n            truncateAt(fullText, idx);\n\n            if (fits()) {\n                bestBreakIdx = idx;\n                idx = findNextCharacter(fullText, idx);\n            } else {\n                break;\n            }\n        }\n\n        truncateAt(fullText, bestBreakIdx);\n    }\n}\n\nexport function truncateText(element: HTMLElement, maxHeight: number, lineHeight?: number) {\n    truncateWorker(\n        element,\n        maxHeight,\n        element.innerText,\n        (text: string, idx: number) => {\n            element.innerText = text.substring(0, idx) + \"...\";\n        },\n        lineHeight\n    );\n}\n\n/**\n * {@link truncate} has been deprecated and is no longer in use internally. This policy passes\n * content through as it always has, which is _supposed_ to be dealing with text only (see {@link\n * TextBlock.truncateIfSupported}), but had a bug where it might actually pass through an element\n * for which innerHTML yielded actual HTML (since fixed).\n */\nconst ttDeprecatedPolicy = (typeof window === 'undefined') ? undefined : window.trustedTypes?.createPolicy(\"adaptivecards#deprecatedExportedFunctionPolicy\", {\n    createHTML: (value) => value\n});\n\n/** @deprecated Use {@link truncateText} instead. */\nexport function truncate(element: HTMLElement, maxHeight: number, lineHeight?: number) {\n    truncateWorker(\n        element,\n        maxHeight,\n        element.innerHTML,\n        (text: string, idx: number) => {\n            const truncatedString = text.substring(0, idx) + \"...\";\n            const truncatedHTML =\n                ttDeprecatedPolicy?.createHTML(truncatedString) ?? truncatedString;\n            element.innerHTML = truncatedHTML as string;\n        },\n        lineHeight\n    );\n}\n\nfunction findBreakableIndices(html: string): number[] {\n    const results: number[] = [];\n    let idx = findNextCharacter(html, -1);\n\n    while (idx < html.length) {\n        if (html[idx] === \" \") {\n            results.push(idx);\n        }\n\n        idx = findNextCharacter(html, idx);\n    }\n\n    return results;\n}\n\nfunction findNextCharacter(html: string, currIdx: number): number {\n    currIdx += 1;\n\n    // If we found the start of an HTML tag, keep advancing until we get\n    // past it, so we don't end up truncating in the middle of the tag\n    while (currIdx < html.length && html[currIdx] === \"<\") {\n        while (currIdx < html.length && html[currIdx++] !== \">\") {\n            continue;\n        }\n    }\n\n    return currIdx;\n}\n\nexport function getFitStatus(element: HTMLElement, containerEnd: number): Enums.ContainerFitStatus {\n    const start = element.offsetTop;\n    const end = start + element.clientHeight;\n\n    if (end <= containerEnd) {\n        return Enums.ContainerFitStatus.FullyInContainer;\n    } else if (start < containerEnd) {\n        return Enums.ContainerFitStatus.Overflowing;\n    } else {\n        return Enums.ContainerFitStatus.FullyOutOfContainer;\n    }\n}\n\nexport function getScrollX(): number {\n    return window.pageXOffset;\n}\n\nexport function getScrollY(): number {\n    return window.pageYOffset;\n}\n\nexport function clearElementChildren(element: HTMLElement) {\n    while (element.firstChild) {\n        element.removeChild(element.firstChild);\n    }\n}\n\nexport function addCancelSelectActionEventHandler(element: HTMLElement) {\n    element.onclick = (e) => {\n        e.preventDefault();\n        e.cancelBubble = true;\n    };\n}\n\nexport function debounce(fn: (...args: unknown[]) => unknown, delay: number) {\n    let timer: NodeJS.Timeout;\n    function debouncedFn(...args: unknown[]) {\n        if (timer) {\n            clearTimeout(timer);\n        }\n        timer = setTimeout(() => {\n            fn(...args);\n        }, delay);\n    }\n    return debouncedFn;\n}\n"]}},"error":null,"hash":"9c44a8dc1471286700f003a183799e40","cacheData":{"env":{}}}